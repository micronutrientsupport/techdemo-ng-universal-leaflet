language: node_js
node_js:
  - "12"
dist: trusty
sudo: required
# branches:
#   only:
#     - main
before_script:
  - npm install -g @angular/cli
script:
  - ng lint
  - npm run build:ssr
  - npm run bing
  # - run-p bing pa11y pa11yJson
  # - run p pa11y pa11yJson
  # - npm run pa11y
  - npm run pa11yJson
  - npm run pa11yReporter
  # - npm run serve:ssr
  # - pa11y-ci -c ./.pa11yci

deploy:
  provider: pages
  cleanup: false
  local_dir: pa11y
  token: $GIT_TOKEN
  keep_history: true
  target_branch: gh-pages
